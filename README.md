# 🚨 Manufacturing Safety Accident Detection System  
### (ResNet18 + LSTM, 20-Frame CNN–LSTM)

> 제조 현장 CCTV 기반 인명사고(끼임·떨어짐·부딪힘·쓰러짐·물체에 맞음)를  
> 20프레임 시퀀스 기반으로 실시간 탐지·분류하는 경량 시공간 통합 딥러닝 모델

---

## 📌 Project Overview

제조 현장의 인명사고는 대부분 0.5~2초 이내 급격히 발생합니다.  
단일 프레임 기반 CNN은 이러한 동작 변화를 충분히 반영하기 어렵습니다.

본 프로젝트는:

- 📹 AI-Hub + 실환경 CCTV 기반 사고 데이터셋 구축
- 🧠 ResNet18 (공간 특징) + LSTM (시간 특징) 결합 구조 설계
- 🎞 20프레임 고정 시퀀스 입력 설계
- ⚡ 실시간 추론 가능한 경량 모델 구현
- 📊 사고 유형별 개별 모델 학습 및 성능 분석

---

# 📂 Dataset

## 📌 AI-Hub 데이터 출처

데이터셋명: **스마트 제조 시설 안전 감시를 위한 데이터**

출처:  
https://aihub.or.kr/aihubdata/data/view.do?dataSetSn=71679

해당 데이터는 실제 제조 환경 CCTV 영상 기반으로,  
작업자의 위험 행동 및 사고 상황을 포함합니다.

---

## 📊 데이터 구성

| 데이터명 | 1차분류 | 2차분류 | 수량(CCTV) | 이미지 수 |
|----------|----------|----------|------------|------------|
| 인명사고 | 미사고 | - | 500 | 10,000 |
| 실화상(미사고) | - | - | 16 | 9,600 |
| 사고 | 끼임 | - | 2,000 | 40,000 |
| 사고 | 떨어짐 | - | 2,000 | 40,000 |
| 사고 | 물체에 맞음 | - | 1,700 | 34,000 |
| 사고 | 부딪힘 | - | 1,400 | 28,000 |
| 사고 | 쓰러짐 | - | 1,400 | 28,000 |
| **총계** |  |  | **9,016** | **189,600** |

---

## 🔄 실환경 데이터 보강

AI-Hub 데이터 외에도 실제 제조 환경 CCTV 영상을 수집하여 학습에 포함했습니다.

- 10분 단위 영상 수집
- 초당 1프레임 이미지 추출
- 동일 전처리 파이프라인 적용
- AI-Hub 데이터와 통합 학습

이를 통해 조명·각도 편차에 대한 일반화 성능을 향상시켰습니다.

---

# 🧹 Data Preprocessing (20-Frame 기준)

모델 입력은 항상 20프레임 고정 시퀀스입니다.

입력 텐서 구조: (Batch, 20, 3, 224, 224)



---

## 🔎 구조 설명

### ResNet18 (Spatial Feature Extractor)

- 파라미터 약 11.7M
- 경량 구조
- 각 프레임당 512차원 특징 추출
- 300차원으로 변환 후 LSTM 입력

### LSTM (Temporal Model)

- 20프레임 시퀀스 분석
- hidden size = 256
- 3-layer 구조
- 동작 변화 및 시간 흐름 학습

---

# 📊 Backbone 비교

| 모델 | 평균 추론 시간 (클립당) |
|------|--------------------------|
| ResNet101 | 439ms |
| EfficientNet-B0 | 347ms |
| **ResNet18** | **218ms** |

ResNet18이 정확도·속도·경량성 측면에서 가장 우수하여 최종 선정되었습니다.

---

# 📈 Model Performance

| 사고 유형 | Accuracy |
|------------|-----------|
| 쓰러짐 | 95.1% |
| 떨어짐 | 96.5% |
| 부딪힘 | 98.5% |
| 물체에 맞음 | 90% |
| 끼임 | 92% |

---

## 📊 예시 성능 (Bump 모델)

- Accuracy: 99.26%
- Precision: 97.7%
- Recall: 97.4%
- F1-score: 0.976
- 오탐(FP): 15
- 미탐(FN): 17

---

# ⚙️ Hyper Parameters

| 항목 | 설정값 |
|------|--------|
| 입력 프레임 수 | 20 |
| 입력 크기 | 224×224 |
| LSTM hidden size | 256 |
| LSTM layers | 3 |
| Batch Size | 32 |
| Epoch | 50 |
| Optimizer | Adam |
| Loss | CrossEntropyLoss |
| Train/Val Split | 80:20 |

---

# 🚀 System Advantages

- 단일 CNN 대비 시간 일관성 확보
- 사고 전·중·후 상태 반영
- 3D CNN 대비 연산량 감소
- 실시간 CCTV 서버 환경 적용 가능
- 2D 영상 기반 저비용 구축 가능

---

# 📌 Data Usage Notice

본 프로젝트는 AI-Hub 공개 데이터를 연구·개발 목적으로 활용하였습니다.  
상업적 활용 시 AI-Hub 데이터 사용 정책을 준수해야 합니다.

---

# 👨‍💻 My Role

- 20프레임 시퀀스 구조 설계
- ResNet18 백본 비교 실험 및 선정
- 사고 유형별 개별 이진 모델 구성
- Precision/Recall 기반 오탐·미탐 분석
- 실환경 데이터 추가 학습 및 성능 개선

수행자: 김동언

## 📚 Reference

- CNN-LSTM 기본 구조 참고:
  https://github.com/pranoyr/cnn-lstm

본 프로젝트는 위 구조를 참고하여  
제조 현장 인명사고 데이터에 맞게  
20-Frame 시퀀스 구조, ResNet18 백본,  
LSTM 3-layer 구조로 직접 재설계 및 구현하였습니다.

